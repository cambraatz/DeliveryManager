const DELIVERIES = [
    {
        "MFSTKEY": "044X042125003",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 1,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072053",
        "PRODATE": "04102025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "98C MAINLINE DRIVE",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 102,
        "TTLWGT": 558,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125004",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 2,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072306",
        "PRODATE": "04172025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "98C MAINLINE DRIVE",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 92,
        "TTLWGT": 468,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125003",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 3,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072053",
        "PRODATE": "04102025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "95C MAINLINE DRIVE",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 102,
        "TTLWGT": 558,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125004",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 4,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072306",
        "PRODATE": "04172025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "95C MAINLINE DRIVE",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 92,
        "TTLWGT": 468,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125005",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 5,
        "MFSTDATE": "04212025",
        "PRONUMBER": "69286234",
        "PRODATE": "04152025",
        "SHIPNAME": "HOMEDEPOT.COM WAREHOUSE",
        "CONSNAME": "HOMEDEPOT.COM",
        "CONSADD1": "MARINA MILLER",
        "CONSADD2": "19 PAULINE LANE",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 1,
        "TTLYDS": 0,
        "TTLWGT": 115,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125006",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042126",
        "POWERUNIT": "44",
        "STOP": 6,
        "MFSTDATE": "04212025",
        "PRONUMBER": "69286234",
        "PRODATE": "04152025",
        "SHIPNAME": "HOMEDEPOT.COM WAREHOUSE",
        "CONSNAME": "HOMEDEPOT.COM",
        "CONSADD1": "MARINA MILLER",
        "CONSADD2": "19 PAULINE LANE",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 1,
        "TTLYDS": 0,
        "TTLWGT": 115,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125007",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042127",
        "POWERUNIT": "44",
        "STOP": 7,
        "MFSTDATE": "04212025",
        "PRONUMBER": "69286234",
        "PRODATE": "04152025",
        "SHIPNAME": "HOMEDEPOT.COM WAREHOUSE",
        "CONSNAME": "HOMEDEPOT.COM",
        "CONSADD1": "MARINA MILLER",
        "CONSADD2": "19 PAULINE LANE",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 1,
        "TTLYDS": 0,
        "TTLWGT": 115,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125008",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 8,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072053",
        "PRODATE": "04102025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "155C MAINLINE DRIVE",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 102,
        "TTLWGT": 558,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
    {
        "MFSTKEY": "044X042125008",
        "STATUS": "0",
        "ADDDATETIME": "20250420231854",
        "LASTUPDATE": "20250420231854",
        "USERNAME": "system",
        "MFSTNUMBER": "044X042125",
        "POWERUNIT": "44",
        "STOP": 9,
        "MFSTDATE": "04212025",
        "PRONUMBER": "14072053",
        "PRODATE": "04102025",
        "SHIPNAME": "ENGINEERED FLOORS/NE DIRECT",
        "CONSNAME": "WAGNER RUG & FLOORING LLC",
        "CONSADD1": "155C MAINLINE DR",
        "CONSADD2": "",
        "CONSCITY": "WESTFIELD",
        "CONSSTATE": "MA",
        "CONSZIP": "01085",
        "TTLPCS": 2,
        "TTLYDS": 102,
        "TTLWGT": 558,
        "DLVDDATE": null,
        "DLVDTIME": null,
        "DLVDPCS": null,
        "DLVDSIGN": null,
        "DLVDNOTE": null,
        "DLVDIMGFILELOCN": null,
        "DLVDIMGFILESIGN": null
    },
]

const packageDeliveries = (deliveries) => {
    const sharedAddress = (a,b) => {
        if (a.CONSADD1 === b.CONSADD1 && a.CONSADD2 === b.CONSADD2) {
            return true;
        }
        return false;
    };

    let i = 0;
    //let delivery = null;
    let currStop = null;
    let packagedDeliveries = {};

    while (i < deliveries.length) {
        if (currStop && sharedAddress(deliveries[i],currStop)){ // add a helper to simplify equivalence...
            console.log(`Duplicate addresses found: ${deliveries[i].CONSADD1}, ${deliveries[i].CONSADD2}`);
            let sharedDeliveries = [currStop];
            while (sharedAddress(deliveries[i],currStop)) {
                sharedDeliveries.push(deliveries[i]);
                i += 1
            }
            packagedDeliveries[currStop.STOP] = sharedDeliveries;
        }
        else {
            console.log(`New delivery added to dictionary: ${deliveries[i]}`);
            currStop = deliveries[i];
            packagedDeliveries[deliveries[i].STOP] = [ deliveries[i] ];
            i += 1;
        }
    }

    return packagedDeliveries;
};

const deliveries = packageDeliveries(DELIVERIES);
Object.entries(deliveries).map(([key,value]) => {
    if (value.length > 1) {
        console.log(`stop: ${key}, delivery(s):`);
        value.forEach((delivery) => {
            console.log(delivery.STOP);
        });
    } else {
        console.log(`stop: ${key}, delivery(s): ${value[0].STOP}`);
    }
})